<!Doctype html>
<html xmlns=http://www.w3.org/1999/xhtml>
<head>                  
    <meta http-equiv=Content-Type content="text/html;charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
    <meta content=always name=referrer>
    <title>懋特 定位</title>
    <link rel="stylesheet" href="http://map.intmote.com/map/css/ol.css" type="text/css">
    <link rel="stylesheet" href="http://map.intmote.com/map/css/ol3-layerswitcher.css" type="text/css" />
    <link rel="stylesheet" href="http://map.intmote.com/map/css/ol3-base_3d.css" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
 	<script type="text/JavaScript" src="http://map.intmote.com/map/js/Basejs/jquery-1.9.1.js" ></script>	
    <!-- <script type="text/JavaScript" src="http://192.168.1.126:8080/webgis/cyt_test/js/ol.js"></script> -->
    <script type="text/JavaScript" src="http://map.intmote.com/map/js/Basejs/ol-debug.js"></script>
	<script type="text/JavaScript" src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Basejs/ol3-layerswitcher.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Basejs/coordtransform.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Common/ol3-common.js"></script>
	
	<script type="text/javascript" src="http://map.intmote.com/map/js/ElectronicFence/ElectronicFence_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Collection/Collection_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/SearchPoi/SearchPoi_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Heatmap/Heatmap_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Distance/Distance_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/RoutePlan/RoutePlan_h.js"></script>	
	
	<script type="text/javascript" src="http://map.intmote.com/map/js/Common/ol3-style.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Common/ol3-base_init.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Common/ol3-base_fun.js"></script>
	
	<script type="text/javascript" src="http://map.intmote.com/map/js/ElectronicFence/ElectronicFence.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Collection/Collection.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/SearchPoi/SearchPoi.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Heatmap/Heatmap.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/Distance/Distance.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/RoutePlan/RoutePlan.js"></script>

	<link rel="stylesheet" href="http://map.intmote.com/map/js/Cesium/Build/Cesium/Widgets/widgets.css" type="text/css">
	<script type="text/javascript" src="http://map.intmote.com/map/js/Cesium/Build/Cesium/Cesium.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/3dmap/3d_load_h.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/3dmap/3d_index.js"></script>
	<script type="text/javascript" src="http://map.intmote.com/map/js/3dmap/3d_load.js"></script>
	
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<script src="https://use.fontawesome.com/546fdd4a00.js"></script>
	<!-- <link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css"/> -->
    <!-- <link rel="stylesheet" href="http://cache.amap.com/lbs/static/jquery.range.css" />	 -->
    <!-- <script src="http://cache.amap.com/lbs/static/es5.min.js"></script> -->
	<!-- 公交到达圈//标尺//正向地理编码//路径规划//地址自动补全 -->
	<!-- <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=22d3816e107f199992666d6412fa0691&plugin=AMap.ArrivalRange,AMap.Scale,AMap.Geocoder,AMap.Transfer,AMap.Autocomplete,AMap.PlaceSearch,AMap.AdvancedInfoWindow"></script> -->
	<!-- <script type="text/javascript" src="http://cache.amap.com/lbs/static/jquery.range.js"></script> -->
	<!-- <script type="text/javascript" src="http://cache.amap.com/lbs/static/addToolbar.js"></script> -->
	<!-- <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=wNdy48s7V1izbLL0ziswArXq"></script> -->
</head>

<body >
    <div id="map" class="map"  style="width:100%"></div>
	<div id="cesiumContainer" class="map" style="width:0%; right: 0px; background-color: rgba(148,148,248,0.3)"></div>
    <button onclick="backcenter();" type="button" class="control-locate btn btn-default">
		<img style="width:1em" src="./icon/locate.png" />
		<!-- <i class="glyphicon glyphicon-map-marker"></i> -->
	</button>
    <div class="feature-select">
        <ul class="nav nav-pills nav-stacked">
            <li class="dropdown" id="changeMap-Act" onClick="changeMap('to3d');">
				<a href="#">
					<!-- 2,3D切换 -->
					<img style="width:1.2em" id="changeMap-Img" src="./icon/3d.png" />
					<!-- <i class="fa fa-star"></i> -->
				</a>
			</li>
			<li class="divider"></li>
            <li class="dropdown">
                <a href="#" data-toggle="dropdown" class="dropdown-toggle">
					<!-- 检索 -->
                    <img style="width:1.2em" src="./icon/search.png" />
					<!-- <i class="fa fa-search"></i> -->
                </a>
                <ul class="dropdown-menu feature-list">
                    <!-- <li class="dropdown-header">查找</li> -->
					<!-- <li class="divider"></li> -->
                    <li id="selectToilet" onclick="selectToilet();"><a href="#">WC</a></li>
                    <li class="divider"></li>
					<li id="selectDoor" onclick="selectDoor();"><a href="#">大门</a></li>
                </ul>
            </li>
			<li class="divider"></li>
            <li class="dropdown">
                <a href="#" data-toggle="dropdown" class="dropdown-toggle">
					<!-- 导览 -->
                    <img style="width:1.2em" src="./icon/heatmap.png" />
					<!-- <i class="fa fa-picture-o"></i> -->
                </a>
                <ul class="dropdown-menu feature-list">
                    <!-- <li class="dropdown-header">导览</li> -->
                    <li id="guideHeatmap" onclick="guideHeatmap();"><a href="#">热力图</a></li>
                    <li class="divider"></li>
					<li id="guideGuidemap" onclick="guideGuidemap();"><a href="#">导览图</a></li>
                </ul>
            </li>
			<li class="divider"></li>
            <li class="dropdown">
                <a href="#" data-toggle="dropdown" class="dropdown-toggle">
                    <!-- 测距 -->
					<img style="width:1.2em" src="./icon/length.png" /> 
					<!-- <i class="fa fa-arrows-h"></i> -->
				</a>
                <ul class="dropdown-menu feature-list">
                    <!-- <li class="dropdown-header">测距</li> -->
                    <li id="startLength" onclick="startLength();"><a href="#">开始</a></li>
                    <li class="divider"></li>
					<li id="stopLength" onclick="stopLength();"><a href="#">停止</a></li>
                    <li class="divider"></li>
					<li id="removeLength" onclick="removeLength();"><a href="#">清除</a></li>
                </ul>
            </li>
			<li class="divider"></li>
            <li class="dropdown" onClick="pathPlanningMain();">
                <a href="#" data-toggle="modal" data-target="#pathModal">
					<!-- 路径规划 -->
                    <img style="width:1.2em" src="./icon/route-planning.png" />
					<!-- <i class="fa fa-level-up"></i> -->
				</a>
            </li>
			<li class="divider"></li>
            <li class="dropdown" onClick="collectionPoi();">
				<a href="#">
					<!-- 收藏 -->
					<img style="width:1.2em" src="./icon/collection.png" />
					<!-- <i class="fa fa-star"></i> -->
				</a>
			</li>
			<li class="divider"></li>
            <li class="dropdown">
                <a href="#" data-toggle="dropdown" class="dropdown-toggle">
					<!-- 电子围栏 -->
					<img style="width:1.2em" src="./icon/electronicFence.png" />
					<!-- <i class="fa fa-ban"></i> -->
				</a>
                <ul class="dropdown-menu feature-list">
                    <li id="electronicFence" onclick="electronicFence();"><a href="#">显示</a></li>
                    <li class="divider"></li>
					<li id="AddElectronicFence" onclick="UpdateElectronicFence(this);"><a href="#">新增</a></li>
                    <li class="divider"></li>
					<li id="UpdateElectronicFence" onclick="UpdateElectronicFence(this);"><a href="#">修改</a></li>
                    <li class="divider"></li>
					<li id="RemoveElectronicFence" onclick="UpdateElectronicFence(this);"><a href="#">删除</a></li>
                    <li class="divider"></li>
					<li id="electronicFenceDrawOFF" onclick="electronicFenceDrawOFF();"><a href="#">停止</a></li> 
					<li class="divider"></li>
					<li id="SaveElectronicFence" onclick="SaveElectronicFence();"><a href="#">保存</a></li>
                </ul>
            </li>
            <!-- <li class="dropdown" onClick="electronicFence();"><a href="#"><i class="fa fa-ban"></i></a></li> -->
        </ul>
    </div>
    <div class="floor-select" style="display:none">
        <div class="wheel">
            <ul class="nav nav-pills nav-stacked">
<!--                 <li role="presentation" class="up"><a href="#"><i class="glyphicon glyphicon-chevron-up"></i></a></li> -->
				<li role="presentation" class="nav nav-pills nav-stacked floorshow active"  ><a style="padding: 10px 12px; ">F01</a></li>
				<!-- <li class="divider"></li> -->
				<li class="dropdown">
					<a href="#"role="presentation" data-toggle="dropdown" class="down dropdown-toggle" style="padding: 2px 14px; "><i class="glyphicon glyphicon-chevron-down"></i></a>
					 <ul class="dropdown-menu" style="width:3.1em;min-width:10px;">
						<li class="floor-wheel" >
						<!-- <div class="levels-select"> -->
							<ul class="nav nav-pills nav-stacked " id="floorlist">
							</ul>
						<!-- </div> -->
						</li>	
					</ul>
				</li>	
            </ul>
        </div>
    </div>	
	
    <!--路径规划模态框-->
    <div class="modal fade" id="pathModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                 <!--<div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h6 class="modal-title" id="myModalLabel">路径规划</h6>
                </div> -->
                <div class="modal-body">
                    <form class="form-horizontal">
                        <div class="form-group">
                            <div class="col-xs-7">
                                <div class="input-group has-feedback">
                                    <span class="input-group-addon">起点</span>
                                    <input class="form-control" id="label-start" placeholder="请选择起点">
                                    <a class="btn close form-control-feedback" onClick="clearStartLabel();" style="pointer-events: auto"><span aria-hidden="true">&times;</span></a>
                                </div>
                            </div>
                            <div class="btn-group col-xs-5">
                                <button onclick="getStartLabelFromLocate();" type="button" class="btn btn-default">
									<i class="glyphicon glyphicon-map-marker"></i>
								</button>
                                <button onclick="getStartLabelOnMap();" type="button" class="btn btn-default">
									<i class="glyphicon glyphicon-screenshot"></i>
								</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-7">
                                <div class="input-group has-feedback">
                                    <span class="input-group-addon">终点</span>
                                    <input class="form-control" id="label-end" placeholder="请选择终点">
                                    <a class="btn close form-control-feedback" onClick="clearEndLabel();" style="pointer-events: auto"><span aria-hidden="true">&times;</span></a>
                                </div>
                            </div>
                            <div class="btn-group col-xs-5">
                                <button onclick="getEndLabelFromLocate();" type="button" class="btn btn-default">
									<i class="glyphicon glyphicon-map-marker"></i>
								</button>
                                <button onclick="getEndLabelOnMap();" type="button" class="btn btn-default">
									<i class="glyphicon glyphicon-screenshot"></i>
								</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <!-- <button type="button" class="btn btn-primary" onclick="clearPathPlan();">清空结果</button> -->
                    <button type="button" class="btn btn-warning" onclick="backPathPlan();" data-dismiss="modal">返回</button>
                </div>
            </div>
        </div>
    </div>	
</body>
<script>
	
	// 创建地图
	var amap = new ol.layer.Group({
		title: 'amap',
		layers: [amapLayer],
	});	
	var basemap = new ol.layer.Group({
		title: 'base map',
		layers: [backgroundLayer,polygonLayer,pointLayer],
	});
	var overmap = new ol.layer.Group({
		title: 'over map',
		layers: [LocationLayer,collectionLayer,selectLayer,electronicLayer],
	});
	var selectmap = new ol.layer.Group({
		title: 'select map',
		layers: [selectSingleClickLayter],
	});
		
	var map = new ol.Map({
		logo: {src: './icon/LOGO.png',href: 'http://www.intmote.com/'},
		// 设置显示地图的视图
		view: view,
		// 让id为map的div作为地图的容器
		target: 'map' ,
		layers: [
			amap,
			basemap,
			overmap,
			selectmap
		],
		controls: ol.control.defaults({
			attributionOptions: {collapsible: false}
		})
	});	
	// 设置控件
	map.addControl(new ol.control.Rotate());          // 指北针
	map.addControl(new ol.control.ScaleLine());       // 比例尺
	map.addControl(new ol.control.Zoom());            // 地图缩放
	// map.addControl(new ol.control.LayerSwitcher());   // 图层控制
	map.addOverlay(HighlightOverlay);
	
	// 加载定位信息
	loadlocation(); 

	// 点选元素-高亮
	loadselectSingleClick();
	
	load3dMap();
	

</script>

</html>